---
layout: post
title: 网络库常见的糟糕设计有哪些
---

今天来批判一下 c++ 网络库常见的糟糕设计, 因为很多库作者往往是学而不思, 对于网络库的设计不得要领, 这种现象由其是在国内以 muduo 为代表的糟糕设计的模仿者众多, 废话不多说, 直接进入主题.

1. 网络库不应该 copy 用户要发送的数据.
2. 网络库的 tcp 应该充分利用它本身的窗口特性.
3. 网络库应该做到内部队列数据结构本身的内存分配能由用户指定分配器.
4. 网络库应该支持多种 os 底层接口.
5. 网络库的异步接口应该使用 one op/one callback 机制以适应协程扩展.
6. 不跨平台和不提供异步接口的网络库没有意义.
7. 网络库不应该忽略或隐藏 os 返回的错误代码.

先列出这些主题, 后面有空再更新吧, 再慢慢展开来说...
